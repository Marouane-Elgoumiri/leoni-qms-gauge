<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QK - Audit Produit Faisceaux & Cables - LEONI Quality Management</title>
    <link rel="icon" href="../assets/logo.png?v=2025" type="image/png">
    <link rel="shortcut icon" href="../assets/logo.png?v=2025" type="image/png">
    <link rel="apple-touch-icon" href="../assets/logo.png?v=2025">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="qk-audit.css">
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header-section">
            <div class="header-badge">
                <i class="fas fa-cogs"></i> QK - Audit Produit
            </div>
            <h1 class="page-title">Audit Produit Faisceaux & Cables</h1>
            <p class="page-subtitle">Quality Assessment for Wire Harnesses and Cable Products</p>
        </div>

        <!-- Main Form Container -->
        <div class="form-container">
            <!-- Product Information Section -->
            <div class="form-section">
                <div class="section-header">
                    <i class="fas fa-info-circle"></i>
                    <h2>Informations Produit</h2>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="pieceDescription">
                            <i class="fas fa-cube"></i>
                            Description de la Pièce
                        </label>
                        <input type="text" id="pieceDescription" name="pieceDescription" required>
                    </div>

                    <div class="form-group">
                        <label for="typeVehicule">
                            <i class="fas fa-car"></i>
                            Type Véhicule
                        </label>
                        <select id="typeVehicule" name="typeVehicule" required>
                            <option value="">Sélectionner...</option>
                            <option value="VOLVO_XC90">VOLVO XC90</option>
                            <option value="VOLVO_XC60">VOLVO XC60</option>
                            <option value="VOLVO_XC40">VOLVO XC40</option>
                            <option value="VOLVO_V90">VOLVO V90</option>
                            <option value="VOLVO_S90">VOLVO S90</option>
                            <option value="AUTRE">Autre</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="famille">
                            <i class="fas fa-layer-group"></i>
                            Famille
                        </label>
                        <input type="text" id="famille" name="famille" required>
                    </div>

                    <div class="form-group">
                        <label for="reference">
                            <i class="fas fa-hashtag"></i>
                            Référence
                        </label>
                        <input type="text" id="reference" name="reference" required>
                    </div>

                    <div class="form-group">
                        <label for="indice">
                            <i class="fas fa-sort-numeric-up"></i>
                            Indice
                        </label>
                        <input type="text" id="indice" name="indice" required>
                    </div>

                    <div class="form-group">
                        <label for="departement">
                            <i class="fas fa-building"></i>
                            Département
                        </label>
                        <select id="departement" name="departement" required>
                            <option value="">Sélectionner...</option>
                            <option value="PRODUCTION">Production</option>
                            <option value="QUALITE">Qualité</option>
                            <option value="INGENIERIE">Ingénierie</option>
                            <option value="MAINTENANCE">Maintenance</option>
                            <option value="LOGISTIQUE">Logistique</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="usine">
                            <i class="fas fa-industry"></i>
                            Usine
                        </label>
                        <select id="usine" name="usine" required>
                            <option value="">Sélectionner...</option>
                            <option value="LEONI_BIZERTE">LEONI Bizerte</option>
                            <option value="LEONI_SOUSSE">LEONI Sousse</option>
                            <option value="LEONI_MATEUR">LEONI Mateur</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="auditeur">
                            <i class="fas fa-user-tie"></i>
                            Auditeur
                        </label>
                        <input type="text" id="auditeur" name="auditeur" required>
                    </div>

                    <div class="form-group">
                        <label for="tel">
                            <i class="fas fa-phone"></i>
                            Téléphone
                        </label>
                        <input type="tel" id="tel" name="tel" required>
                    </div>

                    <div class="form-group">
                        <label for="dateAudit">
                            <i class="fas fa-calendar"></i>
                            Date d'Audit
                        </label>
                        <input type="date" id="dateAudit" name="dateAudit" required>
                    </div>
                </div>

                <!-- Test Type Selection -->
                <div class="test-type-section">
                    <h3><i class="fas fa-vial"></i> Type de Test</h3>
                    <div class="test-type-options">
                        <div class="radio-group">
                            <input type="radio" id="destructive" name="testType" value="destructive">
                            <label for="destructive" class="radio-label destructive">
                                <i class="fas fa-hammer"></i>
                                <span>Test Destructif</span>
                                <small>Test avec dégradation du produit</small>
                            </label>
                        </div>
                        <div class="radio-group">
                            <input type="radio" id="nonDestructive" name="testType" value="nonDestructive">
                            <label for="nonDestructive" class="radio-label non-destructive">
                                <i class="fas fa-shield-alt"></i>
                                <span>Test Non-Destructif</span>
                                <small>Test sans dégradation du produit</small>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Evaluation Metrics Section -->
            <div class="form-section">
                <div class="section-header">
                    <i class="fas fa-chart-bar"></i>
                    <h2>Métriques d'Évaluation</h2>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <label for="nombreFaisceaux">
                            <i class="fas fa-plug"></i>
                            Nombre de Faisceaux Vérifiés
                        </label>
                        <input type="number" id="nombreFaisceaux" name="nombreFaisceaux" min="0" required>
                    </div>

                    <div class="metric-card">
                        <label for="pointsDemerites">
                            <i class="fas fa-minus-circle"></i>
                            Points de Démérites
                        </label>
                        <input type="number" id="pointsDemerites" name="pointsDemerites" min="0" step="0.1" required>
                    </div>

                    <div class="metric-card">
                        <label for="facteurEvaluation">
                            <i class="fas fa-calculator"></i>
                            Facteur d'Évaluation
                        </label>
                        <input type="number" id="facteurEvaluation" name="facteurEvaluation" min="0" step="0.01" required>
                    </div>

                    <div class="metric-card">
                        <label for="nombreDefauts">
                            <i class="fas fa-exclamation-triangle"></i>
                            Nombre de Défauts
                        </label>
                        <input type="number" id="nombreDefauts" name="nombreDefauts" min="0" required>
                    </div>

                    <div class="metric-card calculated">
                        <label for="defauts100Points">
                            <i class="fas fa-percentage"></i>
                            Nombre de Défauts à 100 Points
                        </label>
                        <input type="number" id="defauts100Points" name="defauts100Points" readonly>
                        <small class="calculation-note">Calculé automatiquement</small>
                    </div>
                </div>
            </div>

            <!-- Action Management Section -->
            <div class="form-section">
                <div class="section-header">
                    <i class="fas fa-tasks"></i>
                    <h2>Actions d'Amélioration</h2>
                </div>

                <div class="action-controls">
                    <button type="button" id="addActionBtn" class="add-action-btn">
                        <i class="fas fa-plus"></i>
                        Ajouter Action d'Amélioration Type de Défaut
                    </button>
                </div>

                <!-- Actions Table -->
                <div class="table-container" id="actionsTableContainer" style="display: none;">
                    <table class="actions-table" id="actionsTable">
                        <thead>
                            <tr>
                                <th><i class="fas fa-code"></i> Code Défaut</th>
                                <th><i class="fas fa-tag"></i> Type de Défaut</th>
                                <th><i class="fas fa-wrench"></i> Actions d'Amélioration</th>
                                <th><i class="fas fa-clock"></i> Fréquence</th>
                                <th><i class="fas fa-star"></i> Points/Défaut</th>
                                <th><i class="fas fa-sum"></i> Total Points</th>
                                <th><i class="fas fa-cog"></i> Actions</th>
                            </tr>
                        </thead>
                        <tbody id="actionsTableBody">
                            <!-- Rows will be added dynamically -->
                        </tbody>
                        <tfoot>
                            <tr class="corrective-action-row">
                                <td colspan="3" class="corrective-action-cell">
                                    <div class="corrective-action-content">
                                        <label for="actionCorrective">
                                            <i class="fas fa-clipboard-check"></i>
                                            Action d'Amélioration Introduite / Action Corrective
                                        </label>
                                        <textarea id="actionCorrective" name="actionCorrective" rows="3" placeholder="Décrivez l'action corrective mise en place..."></textarea>
                                    </div>
                                </td>
                                <td colspan="3" class="verification-cell">
                                    <div class="verification-content">
                                        <div class="pilot-delai">
                                            <label for="pilotDelai">
                                                <i class="fas fa-user-clock"></i>
                                                Pilote & Délai
                                            </label>
                                            <input type="text" id="pilotDelai" name="pilotDelai" placeholder="Responsable et échéance">
                                        </div>
                                        <div class="verification">
                                            <label for="verification">
                                                <i class="fas fa-check-double"></i>
                                                Vérification
                                            </label>
                                            <select id="verification" name="verification">
                                                <option value="">Statut...</option>
                                                <option value="EN_ATTENTE">En Attente</option>
                                                <option value="EN_COURS">En Cours</option>
                                                <option value="TERMINEE">Terminée</option>
                                                <option value="VALIDEE">Validée</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                                <td class="action-cell">
                                    <div class="table-totals">
                                        <div class="total-item">
                                            <span class="total-label">Total Actions:</span>
                                            <span class="total-value" id="totalActions">0</span>
                                        </div>
                                        <div class="total-item">
                                            <span class="total-label">Total Points:</span>
                                            <span class="total-value" id="totalPoints">0</span>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="window.history.back()">
                    <i class="fas fa-arrow-left"></i>
                    Retour
                </button>
                <button type="button" class="btn btn-outline" id="previewBtn">
                    <i class="fas fa-eye"></i>
                    Aperçu
                </button>
                <button type="button" class="btn btn-primary" id="saveBtn">
                    <i class="fas fa-save"></i>
                    Sauvegarder
                </button>
                <button type="button" class="btn btn-success" id="submitBtn">
                    <i class="fas fa-check"></i>
                    Finaliser l'Audit
                </button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="modal-header success">
                <i class="fas fa-check-circle"></i>
                <h3>Audit Sauvegardé</h3>
            </div>
            <div class="modal-body">
                <p>L'audit QK a été sauvegardé avec succès.</p>
                <div class="audit-summary" id="auditSummary">
                    <!-- Summary will be populated -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="closeModal()">
                    <i class="fas fa-check"></i>
                    OK
                </button>
            </div>
        </div>
    </div>

    <script src="qk-audit.js"></script>
</body>
</html>
